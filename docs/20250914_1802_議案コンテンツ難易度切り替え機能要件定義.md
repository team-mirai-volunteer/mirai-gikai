# 議案コンテンツ難易度切り替え機能 要件定義書

## 1. 概要

### 1.1 目的

国会議案の内容を幅広いユーザー層に理解してもらうため、同一議案に対して 3 段階の難易度別コンテンツを提供し、ユーザーが自身の理解レベルに応じて切り替えられる機能を実装する。

### 1.2 対象範囲

- 全ての議案詳細ページ
- 新規作成される全ての議案コンテンツ

## 2. 機能要件

### 2.1 難易度レベル

以下の 3 段階の難易度を提供する：

| 難易度   | 対象層           | 特徴                                               |
| -------- | ---------------- | -------------------------------------------------- |
| やさしい | 小学生レベル     | 専門用語を避け、日常的な言葉で説明。               |
| ふつう   | 中学生レベル     | 専門用語を最小限に抑え、必要な場合は注釈付きで説明 |
| 難しい   | 一般成人〜専門家 | 専門用語を使用し、詳細な背景情報や法的根拠を含む   |

### 2.2 コンテンツ管理

- **データベース構造**
  - 1 つの議案に対して 3 つのコンテンツバージョンを保持
  - 各難易度ごとに以下の情報を管理：
    - タイトル
    - 要約
    - 本文
    - ポイント解説
    - 影響・効果の説明

### 2.3 UI/UX 要件

#### 2.3.1 切り替え UI

- **配置**: 議案詳細ページのコンテンツ上部
- **デザイン**: 3 つのボタン or セグメントコントロール形式
- **表示**: 現在選択中の難易度を視覚的に明示
- **アイコン**: 各難易度を表すアイコンを併用（例：やさしい=子供のアイコン）

#### 2.3.2 ユーザー設定の永続化

- **保存方法**: Cookie に保存（有効期限: 1 年）
- **Cookie 名**: `content_difficulty_level`
- **値**: `easy` | `normal` | `hard`
- **デフォルト値**: `normal`（ふつう）

#### 2.3.3 画面遷移時の挙動

- 他の議案詳細ページへ遷移しても選択した難易度を維持
- サイト全体で統一された難易度設定を適用

### 2.4 表示切り替え仕様

- 切り替えは即座に反映（ページリロード不要）
- スムーズなトランジション効果を実装
- 切り替え時にスクロール位置を維持

## 3. 非機能要件

### 3.1 パフォーマンス

- 難易度切り替え時のレスポンス: 200ms 以内
- 初回ロード時に 3 段階分のデータを事前取得し、クライアント側でキャッシュ

### 3.2 アクセシビリティ

- キーボード操作での切り替えに対応
- スクリーンリーダー対応
- 適切な ARIA ラベルの設定

### 3.3 レスポンシブ対応

- モバイル、タブレット、デスクトップの各デバイスで最適な表示
- モバイルでは切り替え UI をコンパクトに表示

## 4. データモデル

### 4.1 議案コンテンツテーブル構造

```
bill_contents
- id (Primary Key)
- bill_id (Foreign Key -> bills.id)
- difficulty_level (ENUM: 'easy', 'normal', 'hard')
- title (TEXT)
- summary (TEXT)
- content (TEXT)
- created_at
- updated_at
```

### 4.2 既存テーブルとの関係

- `bills`テーブルと 1 対多の関係（1 つの議案に 3 つのコンテンツ）
- 既存の議案テーブル構造は維持

## 5. API 仕様

### 5.1 議案詳細取得 API

RSC で fetch するので API は不要

<!-- ```
GET /api/bills/{bill_id}
Query Parameters:
  - difficulty: 'easy' | 'normal' | 'hard' (optional, default: Cookie値 or 'normal')

Response:
{
  "bill": {
    "id": "xxx",
    "basic_info": {...}, // 基本情報（難易度に依存しない）
    "content": {
      "difficulty_level": "normal",
      "title": "...",
      "summary": "...",
      "content": "...",
      "key_points": [...],
      "impact_description": "..."
    },
    "available_difficulties": ["easy", "normal", "hard"]
  }
}
``` -->

### 5.2 難易度別コンテンツ取得 API

RSC で fetch するので API は不要

<!-- ```
GET /api/bills/{bill_id}/content/{difficulty}

Response:
{
  "difficulty_level": "easy",
  "title": "...",
  "summary": "...",
  "content": "...",
  "key_points": [...],
  "impact_description": "..."
}
``` -->

## 6. 制約事項

### 6.1 コンテンツ作成

- 全ての議案に対して 3 段階のコンテンツ作成が必須
- コンテンツ作成時は 3 段階同時に作成する運用とする

### 6.2 移行対応

- 既存の議案データは全て削除して新規作成するため、移行作業は不要

## 7. 今後の拡張性

### 7.1 将来的な機能拡張の可能性

- ユーザーアカウントでの難易度設定保存
- 議案以外のコンテンツ（ニュース、解説記事）への適用
- AI による自動難易度調整機能
- ユーザーの理解度テストに基づく推奨難易度の提示

## 8. 成功指標

### 8.1 定量的指標

- 難易度切り替え機能の利用率: 30%以上
- 「やさしい」モードの利用率: 20%以上
- ページ滞在時間の向上: 20%増

### 8.2 定性的指標

- ユーザーからの「理解しやすくなった」というフィードバック
- 幅広い年齢層からのアクセス増加
